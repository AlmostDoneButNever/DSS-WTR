{% extends "normal_layout.html" %}
{% block content %}

<style>
  .form-control {
    display: block;
    width: 100%;
  }
  .form-control-s {
  display: block;
  width: 50%;
  }
  
  select.form-control{
  -webkit-appearance: menulist!important;
  -moz-appearance: menulist!important;
  -ms-appearance: menulist!important;
  -o-appearance: menulist!important;
  appearance: menulist!important;
  }
  </style>

  <div class="content-section" style="margin: 0 auto">
    <h2 style="color:deepskyblue"><strong>Matching</strong></h2>
      <h5>Do you have an existing recycling transaction listed with us? </h5>
      <h6>If yes, please select the Technology ID: </h6>

      <form method='POST'> 
        {{form.csrf_token}} 
        <br>
        <div class="form-group ">
          <h6>Select your Technology ID</h6>
         {{ form.technologyID(class="form-control form-control-sm") }}
        </div>


      
        <div class="form-group">
          <h6>Or enter your technology ID below</h6>
          <textarea class="form-control" name="description" placeholder="Enter the technology ID here..."></textarea>
        </div>

        <div class="form-group">
          {{ form.submit(class="btn btn-success btn-lg") }}
        </div>
      </form>
      
      <h6>If no, please create a new technology ID.</h6>
        <button class="btn btn-primary btn-lg mt-4 mb-0" data-toggle="collapse" data-target="#question">Create New Technology ID</button>
      <br>
      
  </div>

  <br>

  <div class="collapse" id="question">
    <div class="content-section" style="margin: 0 auto">
      <form method='POST'> 
        {{form.csrf_token}} 
        <br>

        <h6>Select the acceptable type of feedstock</h6>

        <div class="row">
          <label class="col-form-label col-sm-1">1)</label>
          <select class="form-control form-control-s col-sm-3" name="tech_waste_id">
            <option value="None">None</option>
            {% for (id , waste) in wastematerial %}
            <option value="{{id}}">{{waste}}</option>
            {% endfor %}
          </select>
        </div>  
        <br>
        <button type="button" class="btn btn-outline-info" onclick="addCode()" id = 'addItembutton'>Add Item</button>  
        <br>   
        <br>

        <div class="form-group">
          {{ form.submit(class="btn btn-success btn-lg") }}
        </div>
      </form>
    </div> 
    <br>
    
  </div>




  <!-- <div class="content-section" style="margin: 0 auto">
    <h2 style="color:deepskyblue"><strong>Dispatch Matching</strong></h2>
      <h5>Click here to continue with dispatch matching</h5>
        <a class="btn btn-success btn-lg mt-4 mb-0" href="{{ url_for('dispatch_matching_questions_waste') }}" role="button">Dispatch Matching</a>
      <br>
  </div> -->

<script>
  index = 1

  function addCode() {
        index += 1
        document.getElementById("addItembutton").insertAdjacentHTML("beforebegin",
        
        `
        <div class="row">
          <label class="col-form-label col-sm-1">${index})</label>
          <select class="form-control form-control-s col-sm-3" name="tech_waste_id_${index}">
            <option value="None">None</option>
            {% for (id , waste) in wastematerial %}
            <option value="{{id}}">{{waste}}</option>
            {% endfor %}
          </select>
        </div>  
        <br>
                
        `

        );
    }

	function showForm(){
		var hiddenInputs = document.getElementsByClassName('hidden');

    for (var i = 0; i != hiddenInputs.length; i++) {
      hiddenInputs[i].style.display = 'block';
    } 
	}

  let maincat_select = document.getElementById('maincat');
  let subcat_select = document.getElementById('subcat');

  maincat_select.onchange = function(){
    maincat = maincat_select.value;
    fetch('/rsp/' + maincat).then(function(response){
      response.json().then(function(data){
        console.table(data);
        let optionHTML = '';
        for (let subcat of data.subcats){
          optionHTML += '<option value="' + subcat.id + '">' + subcat.subcat + '</option>';
        }
        subcat_select.innerHTML = optionHTML;
      });
    });
  }

</script>

{% endblock content %}



